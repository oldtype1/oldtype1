<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="inn">

<resultMap type="ivo" id="innResult">
	<result property="innNo" column="inn_no"/>
	<result property="innName" column="inn_name"/>
	<result property="innCity" column="inn_city"/>
	<result property="innArea" column="inn_area"/>
	<result property="innAddress" column="inn_address"/>
	<result property="innType" column="inn_type"/>
	<result property="acceptableNo" column="inn_acceptable_no"/>
	<result property="innPrice" column="inn_price"/>
	<result property="innInfo" column="inn_info"/>
	<result property="innAvailability" column="inn_availability"/>
	<result property="memberId" column="member_id"/>
</resultMap>

	<sql id="innlist">
		select inn_no,inn_name,inn_city,inn_area,inn_address,inn_type,inn_acceptable_no,
		inn_price,inn_info,inn_availability,member_id from inn
	</sql>
	
	<select id="getmyinnlist" parameterType="hashmap" resultType="ivo" resultMap="innResult">
select inn_no,inn_name,inn_city,inn_area,inn_address,inn_type,inn_acceptable_no,
		inn_price,inn_info,inn_availability,member_id from	
		(
 select  inn_no,inn_name,inn_city,inn_area,inn_address,inn_type,inn_acceptable_no,
		inn_price,inn_info,inn_availability,member_id,ceil(rownum/5) as page
 from
 (
  select  inn_no,inn_name,inn_city,inn_area,inn_address,inn_type,inn_acceptable_no,
		inn_price,inn_info,inn_availability,member_id from inn where member_id=#{member_id}
		order by inn_no desc	
 )
 )   where page=#{pageNo} 
	</select>
	
	 <select id="getTotalPostingCount" resultType="int" parameterType="String">
 	select count(*) from inn where member_id=#{value}
 	</select>
 	
	<select id="selectInnByCityAndAcceptableNo" parameterType="ivo" resultType="ivo" resultMap="innResult">
	<include refid="innlist" />
	where inn_city=#{innCity} and inn_acceptable_no=#{acceptableNo}
	</select>
	
		<select id="selectInnByCheckedAmenity" parameterType="avo" resultType="ivo" resultMap="innResult">
		select inn_no, inn_name, inn_city, inn_area, inn_address, inn_type, inn_acceptable_no, 
inn_price, inn_info,inn_availability,member_id from (select i.inn_no, i.inn_name, i.inn_city, i.inn_area, i.inn_address, i.inn_type, i.inn_acceptable_no, 
i.inn_price, i.inn_info,i.inn_availability,i.member_id, a.amenity_wifi,a.amenity_bed,a.amenity_tv,a.amenity_kitchen,a.amenity_bbq, a.amenity_no
from inn i, amenity a where i.inn_no=a.amenity_no)
where amenity_wifi=#{amenityWiFi} and amenity_bed=#{amenityBed} and amenity_tv=#{amenityTV} and amenity_kitchen=#{amenityKitchen} and amenity_bbq=#{amenityBBQ}
	</select>
	<!-- <select id="getAddressKind" resultType="string">
		select distinct(address) from member
	</select>
	<select id="findByAddress" resultType="mvo">
		<include refid="selectMember" />
		where address=#{value}
	</select>
	<select id="findMemberById" resultType="mvo">
		<include refid="selectMember" />
		where id=#{value}
	</select>
	<insert id="registerMember" parameterType="mvo">
		insert into member(id,password,name,address)
		values(#{id},#{password},#{name},#{address})
	</insert>
	<select id="idcheck" resultType="int">
		select count(*) from member where id=#{value}
	</select>
	<update id="updateMember" parameterType="mvo">
		update member set password=#{password},name=#{name},address=#{address}
		where id=#{id}
	</update> -->
</mapper>
 
 
 
 
 
 
 
 
 
















